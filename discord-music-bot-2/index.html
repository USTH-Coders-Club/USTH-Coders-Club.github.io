<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

        <link rel="icon" href="/assets/images/icon_round_32.png" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter|Roboto">

        <title>[CODE MUSIC BOT FOR DISCORD] - Phần 2: Một số lệnh cơ bản | UCC Blog</title>

        <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>[CODE MUSIC BOT FOR DISCORD] - Phần 2: Một số lệnh cơ bản | UCC Blog</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="[CODE MUSIC BOT FOR DISCORD] - Phần 2: Một số lệnh cơ bản" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Ở Phần 1, UCC đã hướng dẫn các bạn cài đặt môi trường cho con bot hoạt động bao gồm Node.js và một số module đi kèm. Trong bài này, chúng mình sẽ chỉ cho bạn cách thiết lập một tài khoản Bot trong Discord, sau đó đăng nhập nó và code một số lệnh cơ bản bằng Javascript. Oke gét gô!" />
<meta property="og:description" content="Ở Phần 1, UCC đã hướng dẫn các bạn cài đặt môi trường cho con bot hoạt động bao gồm Node.js và một số module đi kèm. Trong bài này, chúng mình sẽ chỉ cho bạn cách thiết lập một tài khoản Bot trong Discord, sau đó đăng nhập nó và code một số lệnh cơ bản bằng Javascript. Oke gét gô!" />
<link rel="canonical" href="https://usth-coders-club.github.io/discord-music-bot-2/" />
<meta property="og:url" content="https://usth-coders-club.github.io/discord-music-bot-2/" />
<meta property="og:site_name" content="UCC Blog" />
<meta property="og:image" content="https://usth-coders-club.github.io/assets/images/posts/2022-05-01-discord-music-bot-2/banner.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-01T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://usth-coders-club.github.io/assets/images/posts/2022-05-01-discord-music-bot-2/banner.jpg" />
<meta property="twitter:title" content="[CODE MUSIC BOT FOR DISCORD] - Phần 2: Một số lệnh cơ bản" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-01T00:00:00+00:00","datePublished":"2022-05-01T00:00:00+00:00","description":"Ở Phần 1, UCC đã hướng dẫn các bạn cài đặt môi trường cho con bot hoạt động bao gồm Node.js và một số module đi kèm. Trong bài này, chúng mình sẽ chỉ cho bạn cách thiết lập một tài khoản Bot trong Discord, sau đó đăng nhập nó và code một số lệnh cơ bản bằng Javascript. Oke gét gô!","headline":"[CODE MUSIC BOT FOR DISCORD] - Phần 2: Một số lệnh cơ bản","image":"https://usth-coders-club.github.io/assets/images/posts/2022-05-01-discord-music-bot-2/banner.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://usth-coders-club.github.io/discord-music-bot-2/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://usth-coders-club.github.io/assets/images/logo_fixed.png"}},"url":"https://usth-coders-club.github.io/discord-music-bot-2/"}</script>
<!-- End Jekyll SEO tag -->


        <link
            rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
            integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
            crossorigin="anonymous"
        />

        <link href="/assets/css/screen.css" rel="stylesheet" />

        <link href="/assets/css/main.css" rel="stylesheet" />
    
        <script src="/assets/js/jquery.min.js"></script>
   
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-36DEMQV4QJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-36DEMQV4QJ');
</script>
   
<!--     <script>
        (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
                i[r] ||
                function () {
                    (i[r].q = i[r].q || []).push(arguments);
                }),
                (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
        })(window, document, "script", "//www.google-analytics.com/analytics.js", "ga");
        ga("create", "G-36DEMQV4QJ", "auto");
        ga("send", "pageview");
    </script> -->
         </head>
     
    <body class="layout-post">
        <!-- defer loading of font and font awesome -->
        <noscript id="deferred-styles">
            <link
                href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i"
                rel="stylesheet"
            />
            <link
                rel="stylesheet"
                href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"
                integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp"
                crossorigin="anonymous"
            />
        </noscript>

        <!-- Begin Menu Navigation
================================================== -->
        <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
            <div class="container pr-0">
                <!-- Begin Logo -->
                <a class="navbar-brand" href="/">
                    <img src="/assets/images/logo_fixed.png" height="50" alt="USTH Coders Club Blog"/>
                </a>
                <!-- End Logo -->

                <button
                    class="navbar-toggler"
                    type="button"
                    data-toggle="collapse"
                    data-target="#navbarMediumish"
                    aria-controls="navbarSupportedContent"
                    aria-expanded="false"
                    aria-label="Toggle navigation"
                >
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarMediumish">
                    <!-- Begin Menu -->

                    <ul class="navbar-nav ml-auto">
                        </li>

                        <li class="nav-item">
                            
                            <a class="nav-link" href="/index.html">Blog</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/categories">Categories</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/about">About</a>
                        </li>

                        <script src="/assets/js/lunr.js"></script>


<style>
    .lunrsearchresult .title {color: #d9230f;}
    .lunrsearchresult .url {color: silver;}
    .lunrsearchresult a {display: block; color: #777;}
    .lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
    .lunrsearchresult a:hover .title {text-decoration: underline;}
</style>


<form class="bd-search" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
    <input type="text" class="form-control text-small launch-modal-search" id="lunrsearch" name="q" maxlength="255" value="" placeholder="Type and enter..."/>
</form>

<div id="lunrsearchresults">
    <ul></ul>
</div>

<script src="/assets/js/lunrsearchengine.js"></script>
                    </ul>

                    <!-- End Menu -->
                </div>
            </div>
        </nav>
        <!-- End Navigation
================================================== -->

        <div class="site-content">
            <div class="container">
                <!-- Site Title
================================================== -->
                <div class="mainheading">
                    <h1 class="sitetitle">USTH Coders Club Blog</h1>
                    <p class="lead">Chia sẻ về lập trình</p>
                </div>

                <!-- Content
================================================== -->
                <div class="main-content"><!-- Begin Article
================================================== -->
<div class="container">
    <div class="row">

        <!-- Post Share -->
        <div class="col-md-2 pl-0">
            <div class="share sticky-top sticky-top-offset">
    <p>
        Share
    </p>
    <ul>
        <li class="ml-1 mr-1">
            <a target="_blank" href="https://twitter.com/intent/tweet?text=[CODE MUSIC BOT FOR DISCORD] - Phần 2: Một số lệnh cơ bản&url=https://usth-coders-club.github.io/discord-music-bot-2/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=435');return false;">
                <i class="fab fa-twitter"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://facebook.com/sharer.php?u=https://usth-coders-club.github.io/discord-music-bot-2/" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
                <i class="fab fa-facebook-f"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=https://usth-coders-club.github.io/discord-music-bot-2/" onclick="window.open(this.href, 'linkedin-share','width=550,height=435');return false;">
                <i class="fab fa-linkedin-in"></i>
            </a>
        </li>

    </ul>
    
    <div class="sep">
    </div>
    <ul>
        <li>
        <a class="small smoothscroll" href="#disqus_thread"></a>
        </li>
    </ul>
    
</div>

        </div>

        <!-- Post -->
        

        <div class="col-md-9 flex-first flex-md-unordered">
            <div class="mainheading">

                <!-- Author Box -->
                
                    
                        
                        <div class="row post-top-meta">
                            <div class="col-xs-12 col-md-3 col-lg-2 text-center text-md-left mb-4 mb-md-0">
                                
                                <img class="author-thumb" src="/assets/images/avatar/picklerick.jpg" alt="Đỗ Nhật Thành">
                                
                            </div>
                            <div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left">
                                <a target="_blank" class="link-dark" href="https://thanlanslab.wordpress.com/">Đỗ Nhật Thành</a><a target="_blank" href="" class="btn follow">Follow</a>
                                <div class="author-description text-secondary">UCC Gen2 RnD member.</div>
                            </div>
                        </div>
                    
                

                <!-- Post Title -->
                <h1 class="posttitle">[CODE MUSIC BOT FOR DISCORD] - Phần 2: Một số lệnh cơ bản</h1>

            </div>

            <!-- Adsense if enabled from _config.yml (change your pub id and slot) -->
            
            <!-- End Adsense -->

            <!-- Post Featured Image -->
            

            
            <img class="featured-image img-fluid" src="/assets/images/posts/2022-05-01-discord-music-bot-2/banner.jpg" alt="[CODE MUSIC BOT FOR DISCORD] - Phần 2: Một số lệnh cơ bản">
            

            
            <!-- End Featured Image -->

            <!-- Post Content -->
            <div class="article-post">
                <!-- Toc if any -->
                
                    
                    <div class="toc mt-4 mb-4 lead">
                        <div class="divinline">
                        <h3 class="font-weight-bold">Summary </h3>
                        <a id='btntoc' onclick="tocbtn()">Hide</a>
                        </div>
                        <ul id="my_toc" class="inline_toc">
  <li class="tocp"><a href="#thiết-lập-tài-khoản-cho-bot">Thiết lập tài khoản cho Bot</a>
    <ul>
      <li class="tocp"><a href="#1-đăng-ký-với-discord">1. Đăng ký với Discord</a></li>
      <li class="tocp"><a href="#2-thêm-bot-vào-server">2. Thêm Bot vào Server</a></li>
    </ul>
  </li>
  <li class="tocp"><a href="#code-các-lệnh-cơ-bản-bằng-javascript">Code các lệnh cơ bản bằng Javascript</a>
    <ul>
      <li class="tocp"><a href="#1-đăng-nhập-vào-bot">1. Đăng nhập vào Bot</a></li>
      <li class="tocp"><a href="#2-xử-lý-tin-nhắn-đơn-giản">2. Xử lý tin nhắn đơn giản</a></li>
    </ul>
  </li>
</ul>
                    </div>
                
                <!-- End Toc -->
                <p>Ở Phần 1, <strong>UCC</strong> đã hướng dẫn các bạn cài đặt môi trường cho con bot hoạt động bao gồm <strong>Node.js</strong> và một số module đi kèm. Trong bài này, chúng mình sẽ chỉ cho bạn cách thiết lập một tài khoản Bot trong Discord, sau đó đăng nhập nó và code một số lệnh cơ bản bằng <strong>Javascript</strong>. Oke gét gô!</p>

<h2 id="thiết-lập-tài-khoản-cho-bot">Thiết lập tài khoản cho Bot</h2>

<h3 id="1-đăng-ký-với-discord">1. Đăng ký với Discord</h3>

<p>Để có một con Bot và điều khiển nó bằng code, đầu tiên chúng ta cần phải đăng ký với Discord. Các bạn hãy truy cập <a href="https://discord.com/developers/applications">https://discord.com/developers/appilcation</a>:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled.png" alt="Untitled.png" /></p>

<p>Sau đó hãy bấm nút “<strong>New Application</strong>”, sau đó đặt cho App một cái tên (<strong>Lưu ý</strong>: Tên này chưa phải là tên Bot nha!):</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 1.png" alt="Untitled 1.png" /></p>

<p>Bấm “<strong>Create</strong>” và giao diện dưới đây sẽ hiện ra. Các bạn hãy bấm nút “<strong>Bot</strong>” ở phía bên trái:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 2.png" alt="Untitled 2.png" /></p>

<p>Sau đó bạn bấm “<strong>Add Bot</strong>” để tạo tài khoản bot:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 3.png" alt="Untitled 3.png" /></p>

<p>Discord sẽ cho bạn một tài khoản bot. Tại đây bạn có thể đổi tên cho con bot tùy thích ở ô “<strong>USERNAME</strong>” nha! Sau đó nhớ bấm “<strong>Save changes</strong>” để lưu:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 4.png" alt="Untitled 4.png" /></p>

<p>Tiếp theo, chúng ta cần phải cấp cho Bot một số quyền để nó có thể hoạt động mượt mà. Cuộn xuống một chút bạn sẽ thấy mục “<strong>Privileged Gateway Intents</strong>”, sau đó hãy click vào hai nút này:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 5.png" alt="Untitled 5.png" /></p>

<p>Hai nút đó sẽ cho con Bot của chúng ta có quyền lấy <strong>danh sách thành viên</strong> trong server và <strong>đọc các tin nhắn</strong> được gửi trong server đó.</p>

<h3 id="2-thêm-bot-vào-server">2. Thêm Bot vào Server</h3>

<p>Trước tiên để thêm một con bot vào server, bạn cần tạo một server Discord trước đã. Nếu bạn đã có server rồi thì hãy chắc chắn mình có quyền quản lý server đó, nếu không thì bạn sẽ không thể thêm con Bot vào. Để tạo một server mới, hãy truy cập đến <a href="https://discord.com/channels/@me">https://discord.com/app</a>, sau đó tìm đến nút <strong>+</strong> ở phía bên trái:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 6.png" alt="Untitled 6.png" /></p>

<p>Nhấp “<strong>Create My Own</strong>”:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 7.png" alt="Untitled 7.png" /></p>

<p>Nhấp “<strong>For me and my friends</strong>”:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 8.png" alt="Untitled 8.png" /></p>

<p>Tại đây bạn có thể đặt tên và chọn avatar cho server của mình:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 9.png" alt="Untitled 9.png" /></p>

<p>Bấm “<strong>Create</strong>” là bạn đã có server của riêng mình rồi:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 10.png" alt="Untitled 10.png" /></p>

<p>Bây giờ bạn hãy quay lại với trang <a href="https://discord.com/developers/applications">Applications</a>, và chọn App vừa tạo lúc trước:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 11.png" alt="Untitled 11.png" /></p>

<p>Chọn “<strong>OAuth2</strong>” và “<strong>URL Generator</strong>”:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 12.png" alt="Untitled 12.png" /></p>

<p>Tại đây chúng ta sẽ tạo một đường link để mời Bot vào server. Để làm được việc này, các bạn hãy nhấp ô “<strong>Bot</strong>” và “<strong>Administrator</strong>”:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 13.png" alt="Untitled 13.png" /></p>

<p>Cuộn xuống cuối, bạn sẽ thấy một đường dẫn. Hãy copy đường dẫn này và mở trong một tab mới:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 14.png" alt="Untitled 14.png" /></p>

<p>Tại đây bạn có thể chọn server muốn thêm Bot vào, sau đó bấm “<strong>Continue</strong>”:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 15.png" alt="Untitled 15.png" /></p>

<p>Hooray vậy là con Bot của chúng ta đã ở trong server rồi:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 16.png" alt="Untitled 16.png" /></p>

<h2 id="code-các-lệnh-cơ-bản-bằng-javascript">Code các lệnh cơ bản bằng Javascript</h2>

<p>Oke vậy là khâu chuẩn bị đã xong. Các bạn hãy bật <strong>Visual Studio Code</strong> lên và bắt đầu lập trình thôi. Đầu tiên hãy cài 2 extension là “<strong>Code Runner</strong>” và “<strong>Javascript</strong>” nha:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 17.png" alt="Untitled 17.png" /></p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 18.png" alt="Untitled 18.png" /></p>

<h3 id="1-đăng-nhập-vào-bot">1. Đăng nhập vào Bot</h3>

<p>Ở trong <strong>Visual Studio Code</strong>, các bạn hãy mở thư mục đã tạo từ Phần 1 nhé. Nhấp vào <strong>File →Open Folder</strong> và chọn thư mục của bạn:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 19.png" alt="Untitled 19.png" /></p>

<p>Ở phần 1 chúng ta đã sử dụng lệnh <strong><code class="language-plaintext highlighter-rouge">npm init</code></strong> để tạo file <strong>package.json</strong> quản lý các module. Bây giờ các bạn tạo một file mới tên <strong>.env</strong> nha (<strong>Lưu ý</strong> dấu chấm là bắt buộc đó):</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 20.png" alt="Untitled 20.png" /></p>

<p>Ở file này, các bạn hãy thêm một dòng “<strong>DISCORD_TOKEN=</strong>” như dưới đây:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 21.png" alt="Untitled 21.png" /></p>

<p>Đến đây, các bạn hãy quay lại trang đăng ký Bot của mình và tìm đến nút “<strong>Reset Token</strong>” trong mục “<strong>Bot</strong>”:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 22.png" alt="Untitled 22.png" /></p>

<p>Nhấp vào đây và một dòng chữ loằng ngoằng sẽ hiện ra:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 23.png" alt="Untitled 23.png" /></p>

<p>Chính cái dòng loằng ngoằng này lại là một chiếc chìa khóa quan trọng giúp bạn đăng nhập được vào con Bot đã tạo và điều khiển nó. Chính vì vậy, bất kỳ ai sở hữu dòng chữ này sẽ có thể điều khiển được con Bot của bạn. Vậy nên <strong>đừng</strong> chia sẻ nó cho ai nhé! (Tẹo nữa mình cũng đổi Token đây). Bấm Copy và Paste nó vào file <strong>.env</strong> của chúng mình nhé:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 24.png" alt="Untitled 24.png" /></p>

<p>Okay, bắt tay vào code thôi! Giờ các bạn hãy tạo một file mới có tên <strong>index.js</strong>:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 25.png" alt="Untitled 25.png" /></p>

<p>Chúng ta sẽ cần đến Token ở file <strong>.env</strong> lúc nãy. Để nạp được file này, ta sẽ sử dụng module <strong>dotenv</strong>. Khai báo module này cũng đơn giản thôi:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">dotenv</span><span class="dl">'</span><span class="p">).</span><span class="nx">config</span><span class="p">();</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Tiếp theo, chúng ta cần nạp hai object là <strong>Client</strong> và <strong>Intents</strong> trong module <strong>discord.js</strong>. <strong>Client</strong> sẽ đảm nhiệm nhiệm vụ tương tác với Discord API, <strong>Intents</strong> sẽ cấp quyền cần thiết cho <strong>Client</strong>:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="p">{</span>
    <span class="nx">Client</span><span class="p">,</span>
    <span class="nx">Intents</span><span class="p">,</span>
<span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">discord.js</span><span class="dl">'</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Chúng ta sẽ nạp object <strong>Player</strong> trong module <strong>discord-player</strong>. <strong>Player</strong> sẽ đảm nhiệm nhiệm vụ xử lý các tác vụ về nhạc:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="p">{</span> <span class="nx">Player</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">discord-player</span><span class="dl">'</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Chúng ta sẽ tạo một “<strong>Client</strong>” mới để sử dụng và cấu hình nó với một số quyền:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">({</span> <span class="na">intents</span><span class="p">:</span> <span class="p">[</span>
    <span class="nx">Intents</span><span class="p">.</span><span class="nx">FLAGS</span><span class="p">.</span><span class="nx">GUILDS</span><span class="p">,</span>
    <span class="nx">Intents</span><span class="p">.</span><span class="nx">FLAGS</span><span class="p">.</span><span class="nx">GUILD_MESSAGES</span><span class="p">,</span>
    <span class="nx">Intents</span><span class="p">.</span><span class="nx">FLAGS</span><span class="p">.</span><span class="nx">GUILD_VOICE_STATES</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">GUILD_MEMBERS</span><span class="dl">"</span><span class="p">,</span>
<span class="p">]</span> <span class="p">});</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>client</strong> (object điều khiển bot) mới tạo của chúng ta sẽ có quyền quản lý danh sách server mà nó được thêm vào, quyền đọc tin nhắn trong server, quyền lấy trạng thái kênh voice và quyền lấy danh sách thành viên trong server. Tiếp theo chúng ta cũng sẽ tạo một “<strong>Player</strong>” mới để sử dụng:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">player</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Player</span><span class="p">(</span><span class="nx">client</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Khi chúng ta sử dụng Discord, những hành động khác nhau sẽ kích hoạt các hàm khác nhau trong client. Ví dụ như khi chúng ta gửi tin nhắn, react tin nhắn, xóa tin nhắn, … . Các hành động đó gọi là <strong>event</strong>, và con bot của chúng ta sẽ phản hồi lại những event đó theo cách mà chúng ta muốn. Ví dụ, khi con bot của chúng ta đã được login thành công bằng Token, nó sẽ kích hoạt một event gọi là “<strong>ready</strong>”. Dưới đây là đoạn code sẽ được chạy nếu event này được kích hoạt:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nx">client</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ready</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">minccino ready!</span><span class="dl">'</span><span class="p">);</span>
<span class="p">});</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Khi event “<strong>ready</strong>” được kích hoạt, đoạn code trong ngoặc nhọn của chúng ta sẽ được chạy, trong trường hợp này là in ra một dòng “<strong>minccino ready!</strong>”. Tiếp theo chúng ta hãy thử đăng nhập vào con bot nhé:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nx">client</span><span class="p">.</span><span class="nx">login</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DISCORD_TOKEN</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Đoạn <strong><code class="language-plaintext highlighter-rouge">process.env.DISCORD_TOKEN</code></strong> sẽ lấy biến <strong>DISCORD_TOKEN</strong> trong file <strong>.env</strong> của chúng ta. Xong rồi bấm chạy code thôi:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 26.png" alt="Untitled 26.png" /></p>

<p>Dòng “<strong>minccino ready!</strong>” đã được in ra đồng nghĩa con bot của bạn đã được login thành công. Vào trong server Discord bạn có thể thấy nó đang online:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 27.png" alt="Untitled 27.png" /></p>

<h3 id="2-xử-lý-tin-nhắn-đơn-giản">2. Xử lý tin nhắn đơn giản</h3>

<p>Yay! Vậy là chúng ta đã đi được nửa con đường rồi! Con bot này mới chỉ Online thôi chứ vẫn chưa làm được gì cả, vì chúng ta chưa xử lý các event khác. Bây giờ ta sẽ thử làm cho con Bot nói “<strong>Pong</strong>” mỗi khi ta gửi tin nhắn “<strong>Ping</strong>” nhé! Mỗi khi người dùng trong server gửi một tin nhắn, event “<strong>messageCreate</strong>” sẽ được kích hoạt. Các bạn hãy tạo một hàm để xử lý nó nhé:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nx">client</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">messageCreate</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Khi một tin nhắn được gửi đến, event “<strong>messageCreate</strong>” sẽ được kích hoạt và trả về một object tên là “<strong>message</strong>” lưu các thông tin về tin nhắn đó. Chúng ta truyền object này vào đoạn code bên trong ngoặc nhọn và in nó ra màn hình xem nó có những cái gì. Các bạn hãy bấm chạy code, đợi con bot login xong và gửi một tin nhắn bất kỳ vào kênh chat:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 28.png" alt="Untitled 28.png" /></p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 29.png" alt="Untitled 29.png" /></p>

<p>Các bạn có thể thấy Discord trả về rất nhiều thông tin về tin nhắn mình vừa gửi, bao gồm ID mà tin đó được gửi, ID người gửi, thời gian gửi, … . Để con bot phản hồi tin nhắn “<strong>Ping</strong>”, chúng ta cần kiểm tra xem nội dung tin nhắn đó có phải “<strong>Ping</strong>” không:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nx">client</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">messageCreate</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">content</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">Ping</span><span class="dl">"</span><span class="p">){</span>
        
    <span class="p">}</span>
<span class="p">});</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Chúng ta truy cập nội dung tin nhắn bằng <strong>message.content</strong>. Nếu nội dung đúng là “<strong>Ping</strong>”, con Bot sẽ gửi một tin nhắn “<strong>Pong</strong>” vào cùng kênh chat đó. Chúng ta truy cập vào kênh chat của một tin nhắn được gửi bằng <strong><code class="language-plaintext highlighter-rouge">message.channel</code></strong> và gửi tin nhắn vào đó bằng <strong><code class="language-plaintext highlighter-rouge">message.channel.send(”Pong”)</code></strong>:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="nx">client</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">messageCreate</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">content</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">Ping</span><span class="dl">"</span><span class="p">){</span>
        <span class="nx">message</span><span class="p">.</span><span class="nx">channel</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="dl">"</span><span class="s2">Pong</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Oke Ctrl+S để lưu code và chạy thôi:</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre><span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">dotenv</span><span class="dl">'</span><span class="p">).</span><span class="nx">config</span><span class="p">();</span>

<span class="kd">const</span> <span class="p">{</span>
    <span class="nx">Client</span><span class="p">,</span>
    <span class="nx">Intents</span><span class="p">,</span>
<span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">discord.js</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">Player</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">discord-player</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Client</span><span class="p">({</span> <span class="na">intents</span><span class="p">:</span> <span class="p">[</span>
    <span class="nx">Intents</span><span class="p">.</span><span class="nx">FLAGS</span><span class="p">.</span><span class="nx">GUILDS</span><span class="p">,</span>
    <span class="nx">Intents</span><span class="p">.</span><span class="nx">FLAGS</span><span class="p">.</span><span class="nx">GUILD_MESSAGES</span><span class="p">,</span>
    <span class="nx">Intents</span><span class="p">.</span><span class="nx">FLAGS</span><span class="p">.</span><span class="nx">GUILD_VOICE_STATES</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">GUILD_MEMBERS</span><span class="dl">"</span><span class="p">,</span>
<span class="p">]</span> <span class="p">});</span>

<span class="kd">const</span> <span class="nx">player</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Player</span><span class="p">(</span><span class="nx">client</span><span class="p">);</span>

<span class="nx">client</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ready</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">minccino ready!</span><span class="dl">'</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">client</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">messageCreate</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">content</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">Ping</span><span class="dl">"</span><span class="p">){</span>
        <span class="nx">message</span><span class="p">.</span><span class="nx">channel</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="dl">"</span><span class="s2">Pong</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span> 

<span class="nx">client</span><span class="p">.</span><span class="nx">login</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">DISCORD_TOKEN</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p style="text-align: center;"><img src="/assets/images/posts/2022-05-01-discord-music-bot-2/Untitled 30.png" alt="Untitled 30.png" /></p>

<p>Quá tuyệt vời! Vậy là các bạn đã lập trình cho Bot xử lý tin nhắn mà người dùng gửi đến. Trong bài viết tiếp theo, UCC sẽ cùng bạn lập trình các tính năng chơi nhạc cho Bot nhé! Hãy đón chờ nha!</p>

            </div>
            <script src="/assets/js/tocbtn.js"></script>
            <!-- Rating -->
            

            <!-- Post Date -->
            <p>
            <small>
                <span class="post-date"><time class="post-date" datetime="2022-05-01">01 May 2022</time></span>           
                
                </small>
            </p>

            <!-- Post Categories -->
            <div class="after-post-cats">
                <ul class="tags mb-4">
                    
                    
                    <li>
                        <a class="smoothscroll" href="/categories#javascript">javascript</a>
                    </li>
                    
                </ul>
            </div>
            <!-- End Categories -->

            <!-- Post Tags -->
            <div class="after-post-tags">
                <ul class="tags">
                    
                    
                    <li>
                        <a class="smoothscroll" href="/tags#coding">#coding</a>
                    </li>
                    
                </ul>
            </div>
            <!-- End Tags -->

            <!-- Prev/Next -->
            <!-- <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
            
            <a class="prev d-block col-md-6" href="//discord-music-bot-1/"> &laquo; [CODE MUSIC BOT FOR DISCORD] - Phần 1: Cài đặt môi trường</a>
            
            
            <a class="next d-block col-md-6 text-lg-right" href="//discord-music-bot-3/">[CODE MUSIC BOT FOR DISCORD] - Phần 3: Lập trình các tính năng &raquo; </a>
            
            <div class="clearfix"></div>
            </div> -->
            <!-- End Categories -->

        </div>
        <!-- End Post -->

    </div>
</div>
<!-- End Article
================================================== -->

<!-- Begin Comments
================================================== -->
<script src="https://giscus.app/client.js"
        data-repo="USTH-Coders-Club/USTH-Coders-Club.github.io"
        data-repo-id="R_kgDOG_EjEA"
        data-category="Announcements"
        data-category-id="DIC_kwDOG_EjEM4CODbv"
        data-mapping="pathname"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
<!--End Comments
================================================== -->

<!-- Review with LD-JSON, adapt it for your needs if you like, but make sure you test the generated HTML source code first: 
https://search.google.com/structured-data/testing-tool/u/0/
================================================== -->

</div>

                
            </div>

            <!-- Categories Jumbotron
================================================== -->
            <div class="jumbotron fortags">
                <div class="d-md-flex h-100">
                    <div class="col-md-4 transpdark align-self-center text-center h-100">
                        <div class="d-md-flex align-items-center justify-content-center h-100">
                            <h2 class="d-md-block align-self-center py-1 font-weight-light">
                                Explore <span class="d-none d-md-inline">→</span>
                            </h2>
                        </div>
                    </div>
                    <div class="col-md-8 p-5 align-self-center text-center">
                          
                        <a
                            class="mt-1 mb-1"
                            href="/categories#python"
                            >python (1)</a
                        >
                        
                        <a
                            class="mt-1 mb-1"
                            href="/categories#math"
                            >math (1)</a
                        >
                        
                        <a
                            class="mt-1 mb-1"
                            href="/categories#computer-science"
                            >computer science (1)</a
                        >
                        
                        <a
                            class="mt-1 mb-1"
                            href="/categories#skill"
                            >skill (2)</a
                        >
                        
                        <a
                            class="mt-1 mb-1"
                            href="/categories#javascript"
                            >javascript (3)</a
                        >
                        
                        <a
                            class="mt-1 mb-1"
                            href="/categories#Operating-Systems"
                            >Operating Systems (1)</a
                        >
                        
                        <a
                            class="mt-1 mb-1"
                            href="/categories#security"
                            >security (1)</a
                        >
                        
                        <a
                            class="mt-1 mb-1"
                            href="/categories#coding"
                            >coding (1)</a
                        >
                          
                    </div>
                </div>
            </div>

            <!-- Begin Footer
================================================== -->
            <footer class="footer">
                <div class="container">
                    <div class="row">
                        <div class="col-md-6 col-sm-6 text-center text-lg-left">
                            Copyright © 2022 USTH Coders Club Blog
                        </div>
                    </div>
                </div>
            </footer>
            <!-- End Footer
================================================== -->
        </div>
        <!-- /.site-content -->

        <!-- Scripts
================================================== -->

        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
            integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
            crossorigin="anonymous"
        ></script>

        <script
            src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
            integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
            crossorigin="anonymous"
        ></script>

        <script src="/assets/js/mediumish.js"></script>

        

        <script src="/assets/js/ie10-viewport-bug-workaround.js"></script>
    </body>
</html>
