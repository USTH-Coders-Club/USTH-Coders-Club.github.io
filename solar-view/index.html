<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

        <link rel="icon" href="/assets/images/icon_round_32.png" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter|Roboto">

        <title>Ph√¢n t√≠ch l·ªó h·ªïng OS Command Injection trong ·ª©ng d·ª•ng SolarView Compact 6.0 | UCC Blog</title>

        <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Ph√¢n t√≠ch l·ªó h·ªïng OS Command Injection trong ·ª©ng d·ª•ng SolarView Compact 6.0 | UCC Blog</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Ph√¢n t√≠ch l·ªó h·ªïng OS Command Injection trong ·ª©ng d·ª•ng SolarView Compact 6.0" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="H√¥m nay UCC s·∫Ω ƒë·ªïi gi√≥ b·∫±ng m·ªôt b√†i vi·∫øt v·ªÅ ch·ªß ƒë·ªÅ Security. H√£y c√πng ch√∫ng m√¨nh t√¨m hi·ªÉu v·ªÅ m·ªôt trong nh·ªØng l·ªó h·ªïng ·ª©ng d·ª•ng web c∆° b·∫£n nh·∫•t - OS Command Injection - b·∫±ng c√°ch ph√¢n t√≠ch m·ªôt v√≠ d·ª• th·ª±c t·∫ø t·ª´ m·ªôt m√°y ch·ªß ƒë·∫∑t t·∫°i Nh·∫≠t B·∫£n. C√°c nh√† nghi√™n c·ª©u b·∫£o m·∫≠t ƒë√£ t√¨m ra l·ªó h·ªïng OS Command Injection trong ch·ª©c nƒÉng ki·ªÉm tra email c·ªßa ·ª©ng d·ª•ng SolarView Compact phi√™n b·∫£n 6.0. L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c ch∆∞∆°ng tr√¨nh CVE c·ªßa t·∫≠p ƒëo√†n MITRE c√¥ng nh·∫≠n v√† g√°n cho m√£ ƒë·ªãnh danh CVE-2022-29303 v·ªõi ƒëi·ªÉm s·ªë m·ª©c ƒë·ªô nghi√™m tr·ªçng l√† 9.8 CRITICAL, cho ph√©p k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ chi·∫øm quy·ªÅn h·ªá th·ªëng." />
<meta property="og:description" content="H√¥m nay UCC s·∫Ω ƒë·ªïi gi√≥ b·∫±ng m·ªôt b√†i vi·∫øt v·ªÅ ch·ªß ƒë·ªÅ Security. H√£y c√πng ch√∫ng m√¨nh t√¨m hi·ªÉu v·ªÅ m·ªôt trong nh·ªØng l·ªó h·ªïng ·ª©ng d·ª•ng web c∆° b·∫£n nh·∫•t - OS Command Injection - b·∫±ng c√°ch ph√¢n t√≠ch m·ªôt v√≠ d·ª• th·ª±c t·∫ø t·ª´ m·ªôt m√°y ch·ªß ƒë·∫∑t t·∫°i Nh·∫≠t B·∫£n. C√°c nh√† nghi√™n c·ª©u b·∫£o m·∫≠t ƒë√£ t√¨m ra l·ªó h·ªïng OS Command Injection trong ch·ª©c nƒÉng ki·ªÉm tra email c·ªßa ·ª©ng d·ª•ng SolarView Compact phi√™n b·∫£n 6.0. L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c ch∆∞∆°ng tr√¨nh CVE c·ªßa t·∫≠p ƒëo√†n MITRE c√¥ng nh·∫≠n v√† g√°n cho m√£ ƒë·ªãnh danh CVE-2022-29303 v·ªõi ƒëi·ªÉm s·ªë m·ª©c ƒë·ªô nghi√™m tr·ªçng l√† 9.8 CRITICAL, cho ph√©p k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ chi·∫øm quy·ªÅn h·ªá th·ªëng." />
<link rel="canonical" href="https://usth-coders-club.github.io/solar-view/" />
<meta property="og:url" content="https://usth-coders-club.github.io/solar-view/" />
<meta property="og:site_name" content="UCC Blog" />
<meta property="og:image" content="https://usth-coders-club.github.io/assets%5Cimages%5Cposts%5C2022-07-19-solar-view%5Cbanner.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-07-19T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://usth-coders-club.github.io/assets%5Cimages%5Cposts%5C2022-07-19-solar-view%5Cbanner.png" />
<meta property="twitter:title" content="Ph√¢n t√≠ch l·ªó h·ªïng OS Command Injection trong ·ª©ng d·ª•ng SolarView Compact 6.0" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-19T00:00:00+00:00","datePublished":"2022-07-19T00:00:00+00:00","description":"H√¥m nay UCC s·∫Ω ƒë·ªïi gi√≥ b·∫±ng m·ªôt b√†i vi·∫øt v·ªÅ ch·ªß ƒë·ªÅ Security. H√£y c√πng ch√∫ng m√¨nh t√¨m hi·ªÉu v·ªÅ m·ªôt trong nh·ªØng l·ªó h·ªïng ·ª©ng d·ª•ng web c∆° b·∫£n nh·∫•t - OS Command Injection - b·∫±ng c√°ch ph√¢n t√≠ch m·ªôt v√≠ d·ª• th·ª±c t·∫ø t·ª´ m·ªôt m√°y ch·ªß ƒë·∫∑t t·∫°i Nh·∫≠t B·∫£n. C√°c nh√† nghi√™n c·ª©u b·∫£o m·∫≠t ƒë√£ t√¨m ra l·ªó h·ªïng OS Command Injection trong ch·ª©c nƒÉng ki·ªÉm tra email c·ªßa ·ª©ng d·ª•ng SolarView Compact phi√™n b·∫£n 6.0. L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c ch∆∞∆°ng tr√¨nh CVE c·ªßa t·∫≠p ƒëo√†n MITRE c√¥ng nh·∫≠n v√† g√°n cho m√£ ƒë·ªãnh danh CVE-2022-29303 v·ªõi ƒëi·ªÉm s·ªë m·ª©c ƒë·ªô nghi√™m tr·ªçng l√† 9.8 CRITICAL, cho ph√©p k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ chi·∫øm quy·ªÅn h·ªá th·ªëng.","headline":"Ph√¢n t√≠ch l·ªó h·ªïng OS Command Injection trong ·ª©ng d·ª•ng SolarView Compact 6.0","image":"https://usth-coders-club.github.io/assets%5Cimages%5Cposts%5C2022-07-19-solar-view%5Cbanner.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://usth-coders-club.github.io/solar-view/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://usth-coders-club.github.io/assets/images/logo_fixed.png"}},"url":"https://usth-coders-club.github.io/solar-view/"}</script>
<!-- End Jekyll SEO tag -->


        <link
            rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
            integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
            crossorigin="anonymous"
        />

        <link href="/assets/css/screen.css" rel="stylesheet" />

        <link href="/assets/css/main.css" rel="stylesheet" />
    
        <script src="/assets/js/jquery.min.js"></script>
   
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-36DEMQV4QJ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-36DEMQV4QJ');
</script>
   
<!--     <script>
        (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
                i[r] ||
                function () {
                    (i[r].q = i[r].q || []).push(arguments);
                }),
                (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
        })(window, document, "script", "//www.google-analytics.com/analytics.js", "ga");
        ga("create", "G-36DEMQV4QJ", "auto");
        ga("send", "pageview");
    </script> -->
         </head>
     
    <body class="layout-post">
        <!-- defer loading of font and font awesome -->
        <noscript id="deferred-styles">
            <link
                href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i"
                rel="stylesheet"
            />
            <link
                rel="stylesheet"
                href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"
                integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp"
                crossorigin="anonymous"
            />
        </noscript>

        <!-- Begin Menu Navigation
================================================== -->
        <nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">
            <div class="container pr-0">
                <!-- Begin Logo -->
                <a class="navbar-brand" href="/">
                    <img src="/assets/images/logo_fixed.png" height="50" alt="USTH Coders Club Blog"/>
                </a>
                <!-- End Logo -->

                <button
                    class="navbar-toggler"
                    type="button"
                    data-toggle="collapse"
                    data-target="#navbarMediumish"
                    aria-controls="navbarSupportedContent"
                    aria-expanded="false"
                    aria-label="Toggle navigation"
                >
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarMediumish">
                    <!-- Begin Menu -->

                    <ul class="navbar-nav ml-auto">
                        </li>

                        <li class="nav-item">
                            
                            <a class="nav-link" href="/index.html">Blog</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/categories">Categories</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="/about">About</a>
                        </li>

                        <script src="/assets/js/lunr.js"></script>


<style>
    .lunrsearchresult .title {color: #d9230f;}
    .lunrsearchresult .url {color: silver;}
    .lunrsearchresult a {display: block; color: #777;}
    .lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
    .lunrsearchresult a:hover .title {text-decoration: underline;}
</style>


<form class="bd-search" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
    <input type="text" class="form-control text-small launch-modal-search" id="lunrsearch" name="q" maxlength="255" value="" placeholder="Type and enter..."/>
</form>

<div id="lunrsearchresults">
    <ul></ul>
</div>

<script src="/assets/js/lunrsearchengine.js"></script>
                    </ul>

                    <!-- End Menu -->
                </div>
            </div>
        </nav>
        <!-- End Navigation
================================================== -->

        <div class="site-content">
            <div class="container">
                <!-- Site Title
================================================== -->
                <div class="mainheading">
                    <h1 class="sitetitle">USTH Coders Club Blog</h1>
                    <p class="lead">Chia s·∫ª v·ªÅ l·∫≠p tr√¨nh</p>
                </div>

                <!-- Content
================================================== -->
                <div class="main-content"><!-- Begin Article
================================================== -->
<div class="container">
    <div class="row">

        <!-- Post Share -->
        <div class="col-md-2 pl-0">
            <div class="share sticky-top sticky-top-offset">
    <p>
        Share
    </p>
    <ul>
        <li class="ml-1 mr-1">
            <a target="_blank" href="https://twitter.com/intent/tweet?text=Ph√¢n t√≠ch l·ªó h·ªïng OS Command Injection trong ·ª©ng d·ª•ng SolarView Compact 6.0&url=https://usth-coders-club.github.io/solar-view/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=435');return false;">
                <i class="fab fa-twitter"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://facebook.com/sharer.php?u=https://usth-coders-club.github.io/solar-view/" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;">
                <i class="fab fa-facebook-f"></i>
            </a>
        </li>

        <li class="ml-1 mr-1">
            <a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=https://usth-coders-club.github.io/solar-view/" onclick="window.open(this.href, 'linkedin-share','width=550,height=435');return false;">
                <i class="fab fa-linkedin-in"></i>
            </a>
        </li>

    </ul>
    
    <div class="sep">
    </div>
    <ul>
        <li>
        <a class="small smoothscroll" href="#disqus_thread"></a>
        </li>
    </ul>
    
</div>

        </div>

        <!-- Post -->
        

        <div class="col-md-9 flex-first flex-md-unordered">
            <div class="mainheading">

                <!-- Author Box -->
                
                    
                        
                        <div class="row post-top-meta">
                            <div class="col-xs-12 col-md-3 col-lg-2 text-center text-md-left mb-4 mb-md-0">
                                
                                <img class="author-thumb" src="/assets/images/avatar/picklerick.jpg" alt="ƒê·ªó Nh·∫≠t Th√†nh">
                                
                            </div>
                            <div class="col-xs-12 col-md-9 col-lg-10 text-center text-md-left">
                                <a target="_blank" class="link-dark" href="https://thanlanslab.wordpress.com/">ƒê·ªó Nh·∫≠t Th√†nh</a><a target="_blank" href="" class="btn follow">Follow</a>
                                <div class="author-description text-secondary">UCC Gen2 RnD member.</div>
                            </div>
                        </div>
                    
                

                <!-- Post Title -->
                <h1 class="posttitle">Ph√¢n t√≠ch l·ªó h·ªïng OS Command Injection trong ·ª©ng d·ª•ng SolarView Compact 6.0</h1>

            </div>

            <!-- Adsense if enabled from _config.yml (change your pub id and slot) -->
            
            <!-- End Adsense -->

            <!-- Post Featured Image -->
            

            
            <img class="featured-image img-fluid" src="/assets\images\posts\2022-07-19-solar-view\banner.png" alt="Ph√¢n t√≠ch l·ªó h·ªïng OS Command Injection trong ·ª©ng d·ª•ng SolarView Compact 6.0">
            

            
            <!-- End Featured Image -->

            <!-- Post Content -->
            <div class="article-post">
                <!-- Toc if any -->
                
                    
                    <div class="toc mt-4 mb-4 lead">
                        <div class="divinline">
                        <h3 class="font-weight-bold">Summary </h3>
                        <a id='btntoc' onclick="tocbtn()">Hide</a>
                        </div>
                        <ul id="my_toc" class="inline_toc">
  <li class="tocp"><a href="#gi·ªõi-thi·ªáu-v·ªÅ-solarview">Gi·ªõi thi·ªáu v·ªÅ SolarView</a></li>
  <li class="tocp"><a href="#ph√¢n-t√≠ch-l·ªó-h·ªïng-trong-m√£-ngu·ªìn-solarview-compact-60">Ph√¢n t√≠ch l·ªó h·ªïng trong m√£ ngu·ªìn SolarView Compact 6.0</a>
    <ul>
      <li class="tocp"><a href="#code-logic">Code Logic</a></li>
      <li class="tocp"><a href="#khai-th√°c-l·ªó-h·ªïng">Khai th√°c l·ªó h·ªïng</a></li>
    </ul>
  </li>
</ul>
                    </div>
                
                <!-- End Toc -->
                <p>H√¥m nay UCC s·∫Ω ƒë·ªïi gi√≥ b·∫±ng m·ªôt b√†i vi·∫øt v·ªÅ ch·ªß ƒë·ªÅ Security. H√£y c√πng ch√∫ng m√¨nh t√¨m hi·ªÉu v·ªÅ m·ªôt trong nh·ªØng l·ªó h·ªïng ·ª©ng d·ª•ng web c∆° b·∫£n nh·∫•t - <strong>OS Command Injection</strong> - b·∫±ng c√°ch ph√¢n t√≠ch m·ªôt v√≠ d·ª• th·ª±c t·∫ø t·ª´ m·ªôt m√°y ch·ªß ƒë·∫∑t t·∫°i Nh·∫≠t B·∫£n. C√°c nh√† nghi√™n c·ª©u b·∫£o m·∫≠t ƒë√£ t√¨m ra l·ªó h·ªïng OS Command Injection trong ch·ª©c nƒÉng ki·ªÉm tra email c·ªßa ·ª©ng d·ª•ng SolarView Compact phi√™n b·∫£n <strong>6.0</strong>. L·ªó h·ªïng n√†y ƒë√£ ƒë∆∞·ª£c ch∆∞∆°ng tr√¨nh <a href="https://www.redhat.com/en/topics/security/what-is-cve">CVE</a> c·ªßa t·∫≠p ƒëo√†n MITRE c√¥ng nh·∫≠n v√† g√°n cho m√£ ƒë·ªãnh danh <strong>CVE-2022-29303</strong> v·ªõi ƒëi·ªÉm s·ªë m·ª©c ƒë·ªô nghi√™m tr·ªçng l√† <strong>9.8 CRITICAL</strong>, cho ph√©p k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ chi·∫øm quy·ªÅn h·ªá th·ªëng.</p>

<h2 id="gi·ªõi-thi·ªáu-v·ªÅ-solarview">Gi·ªõi thi·ªáu v·ªÅ SolarView</h2>

<p><strong>SolarView Compact</strong> l√† m·ªôt ·ª©ng d·ª•ng web ƒë∆∞·ª£c vi·∫øt b·∫±ng PHP, c√≥ nhi·ªám v·ª• theo d√µi <a href="https://www.contec.com/solutions/energy/solutions/solar-battery/">h·ªá th·ªëng nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi</a> d√†nh cho doanh nghi·ªáp v√† tr∆∞·ªùng h·ªçc do c√¥ng ty Nh·∫≠t B·∫£n <strong>CONTEC</strong> cung c·∫•p. M√¥ h√¨nh chung c·ªßa h·ªá th·ªëng ƒë∆∞·ª£c bi·ªÉu di·ªÖn nh∆∞ h√¨nh minh h·ªça d∆∞·ªõi ƒë√¢y:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled.png" alt="Untitled.png" /></p>

<p>To√†n b·ªô d·ªØ li·ªáu t·ª´ c√°c thi·∫øt b·ªã nh∆∞ t·∫•m pin nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi, c·∫£m bi·∫øn, ‚Ä¶ s·∫Ω ƒë∆∞·ª£c thu th·∫≠p b·ªüi thi·∫øt b·ªã SolarView Compact (c·ª• th·ªÉ l√† m√£ s·∫£n ph·∫©m <a href="https://www.contec.com/products-services/environmental-monitoring/solarview/pv-package/sv-cpt-mc310/feature/#section">SV-CPT-MC310</a>) sau ƒë√≥ hi·ªÉn th·ªã qua m·ªôt ·ª©ng d·ª•ng ch·∫°y tr√™n web server gi√∫p truy c·∫≠p t·ª´ xa:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 1.png" alt="Untitled.png" /></p>

<p>S·∫£n ph·∫©m SV-CPT-MC310 tr√™n trang ch·ªß CONTEC</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 2.png" alt="Untitled.png" /></p>

<p>Giao di·ªán c·ªßa ·ª©ng d·ª•ng web SolarView Compact</p>

<h2 id="ph√¢n-t√≠ch-l·ªó-h·ªïng-trong-m√£-ngu·ªìn-solarview-compact-60">Ph√¢n t√≠ch l·ªó h·ªïng trong m√£ ngu·ªìn SolarView Compact 6.0</h2>

<h3 id="code-logic">Code Logic</h3>

<p>B·∫±ng nh·ªØng ‚Äúbi·ªán ph√°p nghi·ªáp v·ª•‚Äù, UCC ƒë√£ t√¨m ra ƒë·ªãa ch·ªâ IP c·ªßa m·ªôt m√°y ch·ªß Nh·∫≠t B·∫£n ƒëang ch·∫°y phi√™n b·∫£n d√≠nh l·ªó h·ªïng c·ªßa ·ª©ng d·ª•ng SolarView Compact.</p>

<p>L·ªó h·ªïng OS Command Injection t·ªìn t·∫°i trong ch·ª©c nƒÉng ki·ªÉm tra email c·ªßa ·ª©ng d·ª•ng web c√≥ t√™n l√† <strong>conf_mail.php</strong> (giao di·ªán n√†y ƒë√£ ƒë∆∞·ª£c Google Translate t·ª± ƒë·ªông d·ªãch sang Ti·∫øng Anh, ·ªü phi√™n b·∫£n g·ªëc, to√†n b·ªô ch·ªØ tr√™n giao di·ªán l√† Ti·∫øng Nh·∫≠t):</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 3.png" alt="Untitled.png" /></p>

<p>Theo nh∆∞ giao di·ªán, ch√∫ng ta c√≥ th·ªÉ ƒëo√°n ƒë∆∞·ª£c ch·ª©c nƒÉng c·ªßa conf_mail.php l√† g·ª≠i m·ªôt email ki·ªÉm tra ƒë·∫øn ƒë·ªãa ch·ªâ mail m√† ng∆∞·ªùi d√πng nh·∫≠p v√†o:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 4.png" alt="Untitled.png" /></p>

<p>S·ª≠ d·ª•ng ph·∫ßn m·ªÅm <strong>BurpSuite</strong>, ch√∫ng ta c√≥ th·ªÉ quan s√°t ƒë∆∞·ª£c request ƒë∆∞·ª£c tr√¨nh duy·ªát g·ª≠i ƒëi sau khi b·∫•m n√∫t ‚Äúsend e-mail‚Äù:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 5.png" alt="Untitled.png" /></p>

<p>Khi b·∫•m n√∫t ‚Äúsend e-mail‚Äù, tr√¨nh duy·ªát s·∫Ω g·ª≠i m·ªôt <strong>POST</strong> request l√™n <strong>conf_mail.php</strong>, v√† ƒë·ªãa ch·ªâ email ng∆∞·ªùi d√πng nh·∫≠p v√†o s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t b√™n trong parameter ‚Äú<strong>mail_address</strong>‚Äù. C√≤n parameter <strong>button</strong> ch·ªâ l√† t√™n c·ªßa c√°i n√∫t ƒë√≥ (‚Äùsend e-mail‚Äù trong ti·∫øng Nh·∫≠t). To√†n b·ªô ph·∫ßn body ƒë√£ ƒë∆∞·ª£c m√£ h√≥a URL encode.</p>

<p>Ti·∫øp theo ch√∫ng ta s·∫Ω ki·ªÉm tra m√£ ngu·ªìn c·ªßa file <strong>conf_mail.php</strong>:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 6.png" alt="Untitled.png" /></p>

<p>D√≤ng 2, 3, 4, server ƒëang kh·ªüi t·∫°o gi√° tr·ªã c·ªßa 2 bi·∫øn <strong>$button</strong> v√† <strong>$mail_address</strong> d·ª±a theo gi√° tr·ªã c·ªßa 2 parameter t∆∞∆°ng ·ª©ng trong ph·∫ßn body c·ªßa <strong>POST</strong> request m√† ch√∫ng ta ƒë√£ quan s√°t ƒë∆∞·ª£c ·ªü ph√≠a tr√™n:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 7.png" alt="Untitled.png" /></p>

<p>V·∫≠y l√† khi server nh·∫≠n ƒë∆∞·ª£c <strong>POST</strong> request, bi·∫øn <strong>$button</strong> s·∫Ω nh·∫≠n gi√° tr·ªã l√† ch·ªØ ti·∫øng Nh·∫≠t, d·ªãch ra  ‚Äúsend e-mail‚Äù, c√≤n bi·∫øn <strong>$mail_address</strong> nh·∫≠n gi√° tr·ªã l√† ‚Äúadmin@admin.com‚Äù. D√≤ng 6, 7, 8, 9 server ƒëang import m·ªôt s·ªë bi·∫øn v√† h√†m t·ª´ b√™n ngo√†i:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 8.png" alt="Untitled.png" /></p>

<p>D√≤ng 12 server ki·ªÉm tra l·∫°i t√™n c·ªßa bi·∫øn $button xem c√≥ t∆∞∆°ng ƒë∆∞∆°ng v·ªõi n·ªôi dung bi·∫øn <strong>$LABEL_SENDEXEC</strong> hay kh√¥ng (bi·∫øn n√†y c√≥ th·ªÉ server ƒë√£ import t·ª´ d√≤ng 6, 7, 8, 9):</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 9.png" alt="Untitled.png" /></p>

<p>D√≤ng 13, server c·ªë g·∫Øng lo·∫°i b·ªè to√†n b·ªô d·∫•u c√°ch trong bi·∫øn <strong>$mail_address</strong>:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 10.png" alt="Untitled.png" /></p>

<p>Ti·∫øp theo l√† ƒëo·∫°n code th√∫ v·ªã nh·∫•t:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 11.png" alt="Untitled.png" /></p>

<p>D√≤ng 14 ki·ªÉm tra bi·∫øn $mail_address c√≥ ƒë·ªß ƒë·ªô d√†i tr√™n 3 hay kh√¥ng. Ti·∫øn v√†o ƒëo·∫°n code b√™n trong h√†m if, ch√∫ng ta th·∫•y server kh·ªüi t·∫°o m·ªôt bi·∫øn m·ªõi t√™n l√† <strong>$sendmes</strong> c√≥ n·ªôi dung l√† m·ªôt ƒëo·∫°n ti·∫øng Nh·∫≠t n√†o ƒë√≥:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 12.png" alt="Untitled.png" /></p>

<p><strong>Conf_mail.php</strong> ti·∫øp t·ª•c kh·ªüi t·∫°o bi·∫øn <strong>$exec_cmd</strong> c√≥ n·ªôi dung l√† m·ªôt c√¢u l·ªánh Linux c√≥ ch·ª©c nƒÉng th√™m 1 d√≤ng ch·ªØ v√†o file <strong>/dev/elogparam</strong> n·∫±m trong server:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$exec_cmd</span> <span class="o">=</span> <span class="s2">"echo -1 "</span><span class="mf">.</span><span class="nv">$mail_address</span><span class="mf">.</span><span class="s2">" TEST-MAIL '</span><span class="nv">$sendmes</span><span class="s2">' &gt; /dev/elogparam"</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>N·ªôi dung bi·∫øn <strong>$mail_address</strong> v√† <strong>$sendmes</strong> ƒë∆∞·ª£c gh√©p v√†o t·∫°o th√†nh m·ªôt c√¢u l·ªánh ho√†n ch·ªânh l∆∞u trong bi·∫øn <strong>$exec_cmd</strong>. V·∫≠y v·ªõi <strong>mail_address</strong> ch√∫ng ta ban ƒë·∫ßu nh·∫≠p l√† admin@admin.com, bi·∫øn <strong>$exec_cmd</strong> s·∫Ω c√≥ n·ªôi dung nh∆∞ sau:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">echo</span> <span class="nt">-1</span> admin@admin.com TEST-MAIL Êú¨„É°„Éº„É´„ÅØSolarView„ÅåÈÄÅ‰ø°„Åó„Åü„ÉÜ„Çπ„Éà„É°„Éº„É´„Åß„Åô„ÄÇ&gt; /dev/elogparam
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Sau ƒë√≥, <strong>conf_mail.php</strong> th·ª±c thi c√¢u l·ªánh n√†y b·∫±ng c√°ch ƒë∆∞a n·ªôi dung bi·∫øn <strong>$exec_cmd</strong> v√†o h√†m <strong>system()</strong>:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">system</span><span class="p">(</span> <span class="nv">$exec_cmd</span> <span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="khai-th√°c-l·ªó-h·ªïng">Khai th√°c l·ªó h·ªïng</h3>

<p>V·∫≠y ch√≠nh x√°c l·ªó h·ªïng OS Command Injection n·∫±m ·ªü ƒë√¢u? C√¢u tr·∫£ l·ªùi ch√≠nh l√† ·ªü d√≤ng 16, khi server gh√©p n·ªôi dung bi·∫øn <strong>$mail_address</strong> v√†o c√¢u l·ªánh <strong>$exec_cmd</strong>. Do m√£ ngu·ªìn kh√¥ng h·ªÅ c√≥ b∆∞·ªõc thanh l·ªçc user input, k·∫ª t·∫•n c√¥ng thay v√¨ nh·∫≠p m·ªôt email h·ª£p l·ªá nh∆∞ th√¥ng th∆∞·ªùng, h·ªç s·∫Ω ch√®n th√™m c√¢u l·ªánh Linux.</p>

<p>Thay v√¨ nh·∫≠p:</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">admin</span><span class="o">@</span><span class="n">admin</span><span class="mf">.</span><span class="n">com</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>H√°ch c∆° s·∫Ω nh·∫≠p:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="p">;</span><span class="nb">id</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>‚Äúid‚Äù trong Linux l√† m·ªôt c√¢u l·ªánh hi·ªÉn th·ªã th√¥ng tin user hi·ªán t·∫°i. Khi nh·∫≠p payload tr√™n, t·∫°i d√≤ng 16, bi·∫øn <strong>$exec_cmd</strong> s·∫Ω c√≥ gi√° tr·ªã nh∆∞ sau:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">echo</span> <span class="nt">-1</span> <span class="p">;</span><span class="nb">id</span><span class="p">;</span> TEST-MAIL <span class="s1">'$sendmes'</span> <span class="o">&gt;</span> /dev/elogparam
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Nh∆∞ v·∫≠y, khi bi·∫øn n√†y ƒë∆∞·ª£c ƒë∆∞a v√†o h√†m system(), th·ª±c t·∫ø s·∫Ω c√≥ 3 l·ªánh ƒë∆∞·ª£c th·ª±c thi:</p>

<ul>
  <li>echo -1: in ra ‚Äú-1‚Äù</li>
  <li><strong>id</strong>: hi·ªÉn th·ªã th√¥ng tin user</li>
  <li>TEST-MAIL ‚Äò$sendmes‚Äô &gt; /dev/elogparam: ch·∫°y m·ªôt binary c√≥ t√™n ‚ÄúTEST-MAIL‚Äù v√† ƒë∆∞a output v√†o file /dev/elogparam, nh∆∞ng v√¨ binary n√†y kh√¥ng t·ªìn t·∫°i n√™n c√¢u l·ªánh n√†y s·∫Ω b·ªã l·ªói</li>
</ul>

<p>Ch√∫ng ta c√≥ th·ªÉ th·∫•y, k·∫ª t·∫•n c√¥ng ƒë√£ th√†nh c√¥ng trong vi·ªác th·ª±c thi l·ªánh b·∫•t k·ª≥ tr√™n h·ªá th·ªëng b·∫±ng c√°ch s·ª≠ d·ª•ng d·∫•u ; ƒë·ªÉ c√¥ l·∫≠p c√¢u l·ªánh m·ªõi v·ªõi 2 ph·∫ßn tr∆∞·ªõc v√† sau bi·∫øn $exec_cmd g·ªëc. Thay v√¨ ‚Äúid‚Äù, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ th·ª±c hi·ªán b·∫•t k·ª≥ c√¢u l·ªánh n√†o h·ªç mu·ªën, ƒë·ªìng nghƒ©a h·ªç ƒë√£ ki·ªÉm so√°t ƒë∆∞·ª£c server.</p>

<p>H√£y c√πng ki·ªÉm ch·ª©ng v·ªõi m·ª•c ti√™u UCC ƒë√£ t√¨m th·∫•y. S·ª≠ d·ª•ng ph·∫ßn m·ªÅm Burp Suite ƒë·ªÉ thay ƒë·ªïi n·ªôi dung request ƒë·∫øn server:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 13.png" alt="Untitled.png" /></p>

<p>T·∫°i parameter mail_address, ch√∫ng ta thay ƒë·ªïi email th√¥ng th∆∞·ªùng th√†nh ‚Äú<strong>;id</strong>;‚Äù (d·∫•u ; khi ƒë∆∞·ª£c m√£ h√≥a url s·∫Ω tr·ªü th√†nh <strong>%3B</strong>). G·ª≠i request n√†y l√™n server v√† ch√∫ng ta nh·∫≠n ƒë∆∞·ª£c response:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 14.png" alt="Untitled.png" /></p>

<p>Output c·ªßa c√¢u l·ªánh ƒë√£ ƒë∆∞·ª£c tr·∫£ v·ªÅ th√†nh c√¥ng. V·∫≠y c√≤n nh·ªØng c√¢u l·ªánh y√™u c·∫ßu param th√¨ sao? Server ƒë√£ c√≥ m·ªôt d√≤ng code lo·∫°i b·ªè to√†n b·ªô d·∫•u c√°ch. L√†m nh∆∞ th·∫ø n√†o ƒë·ªÉ ch√®n ƒë∆∞·ª£c c√¢u l·ªánh h·ª£p l·ªá ch·ª©a d·∫•u c√°ch?</p>

<p>ƒê·ªÉ bypass d√≤ng code n√†y, ch√∫ng ta s·∫Ω s·ª≠ d·ª•ng bi·∫øn m√¥i tr∆∞·ªùng c√≥ s·∫µn tr√™n Linux ƒë√≥ l√† <strong>IFS</strong>, vi·∫øt t·∫Øt c·ªßa Internal Field Separator (n√≥i tr·∫Øng ra l√† d·∫•u c√°ch). Nh∆∞ v·∫≠y, ƒë·ªÉ th·ª±c thi m·ªôt c√¢u l·ªánh nh∆∞ <code class="language-plaintext highlighter-rouge">cat /etc/passwd</code> tr√™n server, ch√∫ng ta s·∫Ω ch√®n <code class="language-plaintext highlighter-rouge">;cat${IFS}/etc/passwd;</code> d∆∞·ªõi d·∫°ng m√£ h√≥a URL (tu√¢n th·ªß header Content-Type: application/x-www-form-urlencoded)</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 15.png" alt="Untitled.png" /></p>

<p>V√† nh·∫≠n ƒë∆∞·ª£c response:</p>

<p style="text-align: center;"><img src="/assets/images/posts/2022-07-19-solar-view/Untitled 16.png" alt="Untitled.png" /></p>

<p>C√°c b·∫°n h√£y theo d√µi UCC ƒë·ªÉ ƒë√≥n ƒë·ªçc nh·ªØng b√†i vi·∫øt v·ªÅ ch·ªß ƒë·ªÅ Security ti·∫øp theo nh√©!</p>

            </div>
            <script src="/assets/js/tocbtn.js"></script>
            <!-- Rating -->
            

            <!-- Post Date -->
            <p>
            <small>
                <span class="post-date"><time class="post-date" datetime="2022-07-19">19 Jul 2022</time></span>           
                
                </small>
            </p>

            <!-- Post Categories -->
            <div class="after-post-cats">
                <ul class="tags mb-4">
                    
                    
                    <li>
                        <a class="smoothscroll" href="/categories#security">security</a>
                    </li>
                    
                </ul>
            </div>
            <!-- End Categories -->

            <!-- Post Tags -->
            <div class="after-post-tags">
                <ul class="tags">
                    
                    
                    <li>
                        <a class="smoothscroll" href="/tags#code">#code</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/tags#security">#security</a>
                    </li>
                    
                </ul>
            </div>
            <!-- End Tags -->

            <!-- Prev/Next -->
            <!-- <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
            
            <a class="prev d-block col-md-6" href="//giai-bai-tap/"> &laquo; L√†m th·∫ø n√†o ƒë·ªÉ gi·∫£i quy·∫øt c√°c b√†i to√°n g·∫∑p ph·∫£i khi l·∫≠p tr√¨nh? ü§î</a>
            
            
            <a class="next d-block col-md-6 text-lg-right" href="//mot-so-concept-co-ban-react/">M·ªôt s·ªë concepts c∆° b·∫£n c·ªßa React &raquo; </a>
            
            <div class="clearfix"></div>
            </div> -->
            <!-- End Categories -->

        </div>
        <!-- End Post -->

    </div>
</div>
<!-- End Article
================================================== -->

<!-- Begin Comments
================================================== -->
<script src="https://giscus.app/client.js"
        data-repo="USTH-Coders-Club/USTH-Coders-Club.github.io"
        data-repo-id="R_kgDOG_EjEA"
        data-category="Announcements"
        data-category-id="DIC_kwDOG_EjEM4CODbv"
        data-mapping="pathname"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
<!--End Comments
================================================== -->

<!-- Review with LD-JSON, adapt it for your needs if you like, but make sure you test the generated HTML source code first: 
https://search.google.com/structured-data/testing-tool/u/0/
================================================== -->

</div>

                
            </div>

            <!-- Categories Jumbotron
================================================== -->
            <div class="jumbotron fortags">
                <div class="d-md-flex h-100">
                    <div class="col-md-4 transpdark align-self-center text-center h-100">
                        <div class="d-md-flex align-items-center justify-content-center h-100">
                            <h2 class="d-md-block align-self-center py-1 font-weight-light">
                                Explore <span class="d-none d-md-inline">‚Üí</span>
                            </h2>
                        </div>
                    </div>
                    <div class="col-md-8 p-5 align-self-center text-center">
                          
                        <a
                            class="mt-1 mb-1"
                            href="/categories#python"
                            >python (1)</a
                        >
                        
                        <a
                            class="mt-1 mb-1"
                            href="/categories#math"
                            >math (1)</a
                        >
                        
                        <a
                            class="mt-1 mb-1"
                            href="/categories#computer-science"
                            >computer science (1)</a
                        >
                        
                        <a
                            class="mt-1 mb-1"
                            href="/categories#skill"
                            >skill (2)</a
                        >
                        
                        <a
                            class="mt-1 mb-1"
                            href="/categories#javascript"
                            >javascript (3)</a
                        >
                        
                        <a
                            class="mt-1 mb-1"
                            href="/categories#Operating-Systems"
                            >Operating Systems (1)</a
                        >
                        
                        <a
                            class="mt-1 mb-1"
                            href="/categories#security"
                            >security (1)</a
                        >
                        
                        <a
                            class="mt-1 mb-1"
                            href="/categories#coding"
                            >coding (1)</a
                        >
                          
                    </div>
                </div>
            </div>

            <!-- Begin Footer
================================================== -->
            <footer class="footer">
                <div class="container">
                    <div class="row">
                        <div class="col-md-6 col-sm-6 text-center text-lg-left">
                            Copyright ¬© 2022 USTH Coders Club Blog
                        </div>
                    </div>
                </div>
            </footer>
            <!-- End Footer
================================================== -->
        </div>
        <!-- /.site-content -->

        <!-- Scripts
================================================== -->

        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
            integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
            crossorigin="anonymous"
        ></script>

        <script
            src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
            integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
            crossorigin="anonymous"
        ></script>

        <script src="/assets/js/mediumish.js"></script>

        

        <script src="/assets/js/ie10-viewport-bug-workaround.js"></script>
    </body>
</html>
